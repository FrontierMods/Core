[
  {
    "id": "debug_EOC_GET_ITEM_DIMENSIONS",
    "type": "effect_on_condition",

    "effect": [
      {
        "u_run_inv_eocs": "manual",
        "title": "Which item to measure?",
        "true_eocs": [
          {
            "id": "inline_EOC_GET_ITEM_DIMENSIONS",
            "effect": [
              { "math": ["_weight", "=", "n_val('weight')"] },
              { "math": ["_volume", "=", "n_val('volume')"] },

              { "u_message": "Weight: <context_val:weight> mg" },
              { "u_message": "Volume: <context_val:volume> ml" }
            ]
          }
        ]
      }
    ]
  },
  {
    "id": "debug_EOC_SHOW_DEBUG_MESSAGE",
    "type": "effect_on_condition",

    "condition": {
      "and": [
        { "expects_vars": ["message", "tag"] },
        { "u_has_trait": "DEBUG_MOD_REPORTING" }
      ]
    },
    "effect": [
      {
        "if": { "compare_string": ["", { "context_val": "tag" }] },
        "then": { "u_message": { "context_val": "message" } },
        "else": [
          {
            "set_string_var": "[<context_val:tag>] <context_val:message>",
            "target_var": { "context_val": "tagged_message" },
            "parse_tags": true
          },
          { "u_message": { "context_val": "tagged_message" } }
        ]
      }
    ]
  },
  {
    "id": "debug_EOC_SHOW_DEBUG_MESSAGE_SPAMMY",
    "type": "effect_on_condition",

    "condition": {
      "and": [
        { "expects_vars": ["message", "tag"] },
        { "u_has_trait": "DEBUG_MOD_REPORTING_SPAMMY" }
      ]
    },
    "effect": [
      {
        "run_eoc_with": "debug_EOC_SHOW_DEBUG_MESSAGE",
        "variables": {
          "message": { "context_val": "message" },
          "tag": { "context_val": "tag" }
        }
      }
    ]
  }
]
